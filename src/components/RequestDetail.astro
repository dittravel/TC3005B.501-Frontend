---
/**
 * Author: Kenia Esmeralda Ramos Javier.
 * 
 * This component displays the detailed information of a travel 
 * request in a structured and styled way.
 * 
 * Includes a button to navigate back to the requests history.
 */

import TextHeader from '@components/TextHeader.astro';
import Button from '@components/Button';
const { request, title, subtitle } = Astro.props;

---

<main class="flex flex-col items-center">
  <TextHeader
    title={title}
    subtitle={subtitle}
  />

  <div class="w-full flex justify-end mb-6">
    <Button 
      variant="filled"
      color="secondary"
      size="medium"
      href="/dashboard"
    >
      Volver al Dashboard
    </Button>
  </div>
  
  <div class="w-full flex flex-col rounded border border-border p-6 bg-card">
    <p class="mb-12 text-text-primary text-lg">
      <span class="font-medium">Estado: </span><strong>{request.request_status.toUpperCase()}</strong>
    </p>

    <div class="grid grid-cols-2 gap-12 text-lg mb-8 text-text-primary">
      <section class="space-y-4">
        <h2 class="text-2xl font-bold mb-5 border-b-2 border-border pb-2">Detalles del Usuario</h2>
        <div class="grid grid-cols-1 gap-y-2">
          <p><span class="font-medium">Nombre de usuario:</span> {request.user.user_name}</p>
          <p><span class="font-medium">Correo electrónico:</span> {request.user.user_email}</p>
          <p><span class="font-medium">Teléfono:</span> {request.user.user_phone_number}</p>
        </div>
      </section>
      <section>
        <h2 class="text-2xl font-bold mb-5 border-b-2 border-border pb-2">Tarifas y Fechas</h2>
        <div class="grid grid-cols-1 gap-y-2">
          <p><span class="font-medium">Cuota solicitada:</span> ${request.requested_fee.toFixed(2)}</p>
          <p><span class="font-medium">Cuota impuesta:</span> {typeof request.imposed_fee === 'number' && request.imposed_fee > 0 ? `$${request.imposed_fee.toFixed(2)}` : 'SIN ASIGNAR'}</p>
          <p><span class="font-medium">Fecha de creación:</span> {request.creation_date}</p>
        </div>
      </section>
    </div>

    <section class="mb-8 text-text-primary">
      <h2 class="text-2xl font-bold mb-5">Rutas</h2>
      <div>
        {request.routes.map((route:any) => (
          <div class="grid grid-cols-1 md:grid-cols-2 gap-6 routes-wrapper">
            <div>
              <p><span class="font-medium">Origen:</span> {route.origin_city}, {route.origin_country}</p>
              <p><span class="font-medium">Destino:</span> {route.destination_city}, {route.destination_country}</p>
              <p><span class="font-medium">Fecha de salida:</span> {route.beginning_date}</p>
              <p><span class="font-medium">Hora de salida:</span> {route.beginning_time}</p>
              <p><span class="font-medium">Fecha de regreso:</span> {route.ending_date}</p>
              <p><span class="font-medium">Hora de regreso:</span> {route.ending_time}</p>
            </div>
            <div>
              <p><span class="font-medium">Hotel necesario:</span> {route.hotel_needed ? 'Sí' : 'No'}</p>
              <p><span class="font-medium">Avión necesario:</span> {route.plane_needed ? 'Sí' : 'No'}</p>
            </div>
          </div>
        ))}
      </div>
    </section>
    
    {request.notes && (
      <section class="mb-8 text-text-primary font-medium">
        <h2 class="text-2xl font-bold mb-5 border-b-2 border-border pb-2">
          Observaciones / Comentarios
        </h2>
        <p>{request.notes}</p>
      </section>
    )}
  </div>
</main>
